<!-- //////////////////////////////////////////////////////////////////////////////// -->
<!-- /           Código de proyecto control de acceso de empleados                  / -->
<!-- /           Fecha: 25-03-2025                                                  / -->
<!-- /           Programadores:                                                     / -->
<!-- /              * Juan Ruiz                                                     / -->
<!-- /              * Eder Andrade                                                  / -->
<!-- /              * Nelson Velez                                                  / -->
<!-- /              * Abraham Paredes                                               / -->
<!-- /              * Arturo Micaechioni                                            / -->
<!-- /              * Valentina Landazabal                                          / -->
<!-- /              * Henry Cely                                                    / -->
<!-- /              * Diego Parra                                                   / -->
<!-- /              * Fabian Yanes                                                  / -->
<!-- /           Versión: 0.11.5 (versionado semantico)                             / -->
<!-- //////////////////////////////////////////////////////////////////////////////// -->

<!DOCTYPE html>
<html lang="es">             <!-- formulario de inicio sesion de empleados -->
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Registro e inicio de sesión</title>

        <!-- Vinculos de hoja de estilos y normalize -->
        <link rel="stylesheet" href="../css/normalize.css">
        <link rel="stylesheet" href="../css/style.css">

        <!-- Fuentes de la pagina GoogleFonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

        <!-- Vinculo a los archivos JavaScript e IonIcon -->
        <script src="../js/main.js" defer></script>
        <script src="../js/efectos.js" defer></script>
        <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
        <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
        <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
        
        <style>
            /* Estilos para validación */
            .contenedor-input.invalido input {
                border-color: #ff4444;
                box-shadow: 0 0 5px rgba(255, 68, 68, 0.5);
            }
            .contenedor-input.invalido ion-icon {
                color: #ff4444;
            }
            .mensaje-error {
                color: #ff4444;
                font-size: 0.8rem;
                margin-top: 5px;
                display: none;
            }
        </style>
    </head>

    <!-- Cuerpo de la página -->
    <body>

        <!-- Fondo de partículas -->
        <div id="particles-js"></div>

        <!-- Recuadro de opciones -->
        <div class="contenedor-registro">

            <!-- Historial de entradas y salidas -->
            <div class="contenedor-formulario">
                <form method="post" action="../php/historial_accesos2.php" class="formulario-inicio-sesion" id="form-historial">

                    <h2>Historial de accesos</h2>

                    <!-- Contenedor para recibir la fecha al buscar en la base de datos -->
                    <div class="controles-historial">
                        <div class="contenedor-input" id="contenedor-fecha">
                            <ion-icon name="calendar-outline"></ion-icon>
                            <input type="date" 
                                id="fecha-historial" 
                                name="fecha-historial"
                                max="<?php echo date('Y-m-d'); ?>"
                                value="<?php echo date('Y-m-d'); ?>"
                                required>
                            <div class="mensaje-error" id="fecha-error"></div>
                        </div>
                    </div>

                    <!-- Boton de buscar para recibir el historial -->
                    <button type="submit" class="btn-buscar">Buscar</button>
                </form>
            </div>

            <!-- Formulario registro -->
            <div class="contenedor-formulario">
                <form method="post" action="../php/registrar_empleados_copy.php" class="formulario-registro">
                    <h2>Registro</h2>

                    <span>Rellene los campos para registrar al empleado.</span>

                    <!-- Contenedor nombre -->
                    <div class="contenedor-input">
                        <ion-icon name="person-outline"></ion-icon>
                        <input type="text" name="nombre" placeholder="Nombre" required required maxlength="25">
                    </div>

                    <!-- Contenedor usuario -->
                    <div class="contenedor-input">
                        <ion-icon name="person-outline"></ion-icon>
                        <input type="text" name="usuario" placeholder="Apellido" required required maxlength="25">
                    </div>

                    <!-- Contenedor email -->
                    <div class="contenedor-input">
                        <ion-icon name="mail-outline"></ion-icon>
                        <input type="email" name="correo" placeholder="Email" required required maxlength="30">
                    </div>

                    <!-- Contenedor contraseña -->
                    <div class="contenedor-input">
                        <ion-icon name="lock-closed-outline"></ion-icon>
                        <input type="password" name="contrasena" placeholder="Contraseña" required required maxlength="25">
                    </div>

                    <!-- Boton de terminar registro -->
                    <button type="submit" name="btn_register" class="boton-formulario">Registrar</button></a>
                    
                </form>
            </div>
            
            <!-- Seccion de bienvenidas con los distintos botones de cambio de seccion -->
            <div class="contenedor-bienvenida">

                <!-- Seccion para cambiar de inicio de sesión a registro -->
                <div class="bienvenida-registro bienvenida">
                    <img src="../img/logo_usm.png" alt="Logo Santa Maria" class="logo-usm-png">
                    <h3>¡Bienvenido, administrador/a!</h3>
                    <button class="boton-formulario" id="btn-registro">Registrar<ion-icon name="arrow-forward-outline"></ion-icon></button>
                    <button class="boton-formulario" id="btn-registro" onclick="cerrarSesion()">Cerrar sesión<ion-icon name="log-out-outline"></ion-icon></button>
                </div>

                <!-- Seccion para cambiar de registro a inicio de sesion -->
                <div class="bienvenida-inicio-sesion bienvenida">
                    <img src="../img/logo_usm.png" alt="Logo Santa Maria" class="logo-usm-png">
                    <h3>¡Bienvenido, administrador/a!</h3>
                    <button class="boton-formulario" id="btn-inicio-sesion"><ion-icon name="arrow-back-outline"></ion-icon>Historial de acceso</button>
                    <button class="boton-formulario" id="btn-inicio-sesion" onclick="cerrarSesion()"><ion-icon name="log-out-outline"></ion-icon>Cerrar sesión</button>
                </div>
            </div>
        </div>

        <!-- Script de JavaScript para el manejo de errores a la hora de seleccionar una fecha inválida -->
        <script>
            // Validación en tiempo real
            document.getElementById('fecha-historial').addEventListener('change', function() {
                validarFecha(this);
            });
            
            // Validación al enviar el formulario
            document.querySelector('.formulario-inicio-sesion').addEventListener('submit', function(e) {
                const fechaInput = document.getElementById('fecha-historial');
                if (!validarFecha(fechaInput, true)) {
                    e.preventDefault();
                }
            });
            
            function validarFecha(input, esEnvio = false) {
                const contenedor = document.getElementById('contenedor-fecha');
                const mensajeError = document.getElementById('fecha-error');
                const fechaSeleccionada = new Date(input.value);
                const fechaActual = new Date();
                fechaActual.setHours(0, 0, 0, 0);
                
                let valido = true;
                let mensaje = '';
                
                if (!input.value) {
                    mensaje = 'Por favor seleccione una fecha';
                    valido = false;
                } else if (fechaSeleccionada > fechaActual) {
                    mensaje = 'No puede seleccionar una fecha futura';
                    valido = false;
                } else if (fechaSeleccionada < new Date('2020-01-01')) {
                    mensaje = 'La fecha no puede ser anterior al año 2020';
                    valido = false;
                }
                
                if (!valido) {
                    contenedor.classList.add('invalido');
                    mensajeError.textContent = mensaje;
                    mensajeError.style.display = 'block';
                    
                    if (esEnvio) {
                        input.focus();
                    }
                } else {
                    contenedor.classList.remove('invalido');
                    mensajeError.style.display = 'none';
                }
                
                return valido;
            }
        </script>
    </body>
</html>